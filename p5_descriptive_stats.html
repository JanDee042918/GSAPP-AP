<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<script src="//use.typekit.net/hgl4qxi.js"></script>
	<script>try{Typekit.load();}catch(e){}</script>
	<link rel="stylesheet" type="text/css" href="style.css">
	<script type="text/javascript" src="p5/p5.js"></script>
	<style>
	html, body{
		overflow: hidden;
		margin: 0;
		padding: 0;
		background: white;
	}
	</style>
</head>
<script type="text/javascript">

var WIDTH = 1024;
var HEIGHT = 700;
var leftMargin = 20;
var column = 1;

function preload(){
	totalGraduatesTable = loadTable('data/Total_Graduates.csv');
	surveyGraduatesTable = loadTable('data/Degrees.csv');
	console.log('done loading data');
}

function setup(){
	createCanvas(WIDTH, HEIGHT);
	colorMode(HSB, 360, 100, 100, 100);
	textFont("effra");
}

function draw(){
	background(0, 0, 100);

	//Text
	fill(0);
	noStroke();
	textStyle(BOLD);
	textSize(36);
	text("GSAPP", leftMargin, 30);
	textStyle(NORMAL);
	textSize(18);
	text("ALUMNI PROJECT", leftMargin, 50);
	textSize(18);
	textLeading(20);
	text("OVERALL STATISTICS", 190, 3, 100, 100);
	stroke(0);
	strokeWeight(1);
	line(178, 3, 178, 50);
	textSize(20);

	//Buttons
	noFill();
	stroke(0);
	strokeWeight(3);
	for (var i = 0; i < 6; i++) {
		ellipse(50+100*i, 75, 12, 12);
	};
	fill(0);
	noStroke();
	ellipse(50+100*(column-1), 75, 7, 7);
	textSize(12);
	for (var i = 1; i < 7; i++) {
		text(totalGraduatesTable.getColumn(i)[0], 62+100*(i-1), 78);
	};


	//text("GSAPP", leftMargin, 60);
	//text("Our Survey", leftMargin, 80);

	//Bar chart
	textStyle(NORMAL);
	var maxLength = 800;
	var startBar = leftMargin;
	var maxGraduates = 0;
	var totalGraduates = 0;
	for(var i=1; i<8; i++){
		maxGraduates = max(maxGraduates, totalGraduatesTable.getColumn(column)[i]*1);
		totalGraduates = totalGraduates + totalGraduatesTable.getColumn(column)[i]*1;
	}
	for(var i=1; i<8; i++){
		fill(180, 64, 76);
		noStroke();
		rect(startBar, 80+i*40, map(totalGraduatesTable.getColumn(column)[i], 0, maxGraduates, 0, maxLength), 10);
		fill(0);
		textSize(12);
		text(totalGraduatesTable.getColumn(0)[i], startBar, 78+i*40);
		textSize(10);
		text(totalGraduatesTable.getColumn(column)[i]+" ("+round(totalGraduatesTable.getColumn(column)[i]/totalGraduates*100)+"%)", startBar+map(totalGraduatesTable.getColumn(column)[i], 0, maxGraduates, 0, maxLength)+3, 88+i*40);
	}
	maxGraduates = 0;
	totalGraduates = 0;
	for(var i=1; i<8; i++){
		maxGraduates = max(maxGraduates, surveyGraduatesTable.getColumn(column)[i]*1);
		totalGraduates = totalGraduates + surveyGraduatesTable.getColumn(column)[i]*1;
	}
	for(var i=1; i<8; i++){
		fill(3, 78, 95);
		noStroke();
		rect(startBar, 92+i*40, map(surveyGraduatesTable.getColumn(column)[i], 0, maxGraduates, 0, maxLength), 10);
		fill(0);
		text(surveyGraduatesTable.getColumn(column)[i]+" ("+round(surveyGraduatesTable.getColumn(column)[i]/totalGraduates*100)+"%)", startBar+map(surveyGraduatesTable.getColumn(column)[i], 0, maxGraduates, 0, maxLength)+3, 100+i*40);
	}

	if(mouseX > 44 && mouseX < 56 && mouseY > 69 && mouseY < 81){
		cursor(HAND);
	}
	else if(mouseX > 144 && mouseX < 156 && mouseY > 69 && mouseY < 81){
		cursor(HAND);
	}
	else if(mouseX > 244 && mouseX < 256 && mouseY > 69 && mouseY < 81){
		cursor(HAND);
	}
	else if(mouseX > 344 && mouseX < 356 && mouseY > 69 && mouseY < 81){
		cursor(HAND);
	}
	else if(mouseX > 444 && mouseX < 456 && mouseY > 69 && mouseY < 81){
		cursor(HAND);
	}
	else if(mouseX > 544 && mouseX < 556 && mouseY > 69 && mouseY < 81){
		cursor(HAND);
	}
	else{
		cursor(ARROW);
	}
}

function mousePressed(){
	if (mouseX > 44 && mouseX < 56 && mouseY > 69 && mouseY < 81){
		column = 1;
		console.log("1");
	}
	if (mouseX > 144 && mouseX < 156 && mouseY > 69 && mouseY < 81){
		column = 2;
		console.log("2");
	}
	if (mouseX > 244 && mouseX < 256 && mouseY > 69 && mouseY < 81){
		column = 3;
		console.log("3");
	}
	if (mouseX > 344 && mouseX < 356 && mouseY > 69 && mouseY < 81){
		column = 4;
		console.log("4");
	}
	if (mouseX > 444 && mouseX < 456 && mouseY > 69 && mouseY < 81){
		column = 5;
		console.log("5");
	}
	if (mouseX > 544 && mouseX < 556 && mouseY > 69 && mouseY < 81){
		column = 6;
		console.log("6");
	}
}

/*
var column = 1;
var startX = 200;
var graph = 2;

function preload(){
	result = loadTable('data/Degrees.csv');
	totalGraduates = loadTable('data/Total_Graduates.csv');
}

function setup() {
	createCanvas(1024, 768);
	colorMode(HSB, 360, 100, 100, 100);
	textFont("effra");
}


function draw() {
	background(360);
	noStroke();
	fill(0);
	//Title
	textSize(20);
	text("DESCRIPTIVE", 0, 20);
	text("STATISTICS", 0, 40);
	stroke(180, 100, 50);
	strokeWeight(1);
	line(0, 45, 180, 45);
	line(0, 2, 180, 2);
	line(200, 2, 700, 2);

	//Description
	noStroke();
	textSize(12);
	fill(0, 0, 60);
	text("Here is where we describe what's happening with this data, how many people responded, what percentage it is of the whole GSAPP, etc, etc, etc. Just a brief description to explain this dashboard and make an interesting point...", 0, 45, 175, 500);
	
	//Left hand side toggles
	fill(0, 0, 40);
	noStroke();
	rect(0, 200+30*graph, 175, 20);
	noFill();
	stroke(200);
	strokeWeight(1);
	for(var i=0; i<4; i++){
		rect(0, 200+30*i, 175, 20);
	}
	fill(0, 0, 60);
	noStroke();
	textAlign(CENTER);
	text("Respondents per Degree", 87, 215);
	text("Proportion per Class", 87, 245);

	if (graph == 0){
		barChart();
	}
	if (graph ==1){
		circleChart();
	}
	if (graph == 2){
		pieChart();
	}
}

function pieChart(){
	var circleStartY = 125;
	var circleStartX = 290;
	var angles = [30, 10, 45, 35, 60, 38, 75, 67];
	var lastAngle = 0;
	stroke(0);
	strokeWeight(1);
	noFill();
	for(var i=0; i<angles.length; i++){
		arc(circleStartX, circleStartY, 200, 200, lastAngle, lastAngle+radians(angles[i]), PIE);
		lastAngle += radians(angles[i]);
	}
	fill(0, 0, 20);
	ellipse(circleStartX, circleStartY, 125, 125);
}

function circleChart(){
	var circleStartY = 70;
	var circleStartX = 290;
	noFill();
	strokeWeight(1);
	stroke(200);
	for(var i=0; i<6; i++){
		for(var j=0; j<7; j++){
			ellipse(circleStartX+75*i, circleStartY+75*j, 50, 50);
		}
	}
	fill(180, 100, 80);;
	strokeWeight(1);
	stroke(200);
	for(var i=0; i<6; i++){
		for(var j=0; j<7; j++){
			ellipse(circleStartX+75*i, circleStartY+75*j, totalGraduates.getColumn(i+1)[j+10], totalGraduates.getColumn(i+1)[j+10]);
		}
	}
	textAlign(LEFT);
	fill(0, 0, 60);
	noStroke();
	for(var i=0; i<7; i++){
		text(totalGraduates.getColumn(0)[i+1], circleStartX-85, circleStartY+75*i);
	}
	textAlign(CENTER);
	for(var i=0; i<6; i++){
		text(totalGraduates.getColumn(i+1)[0], circleStartX+75*i, circleStartY-45);
	}
	textAlign(LEFT);
	textSize(8);
	for(var i=0; i<6; i++){
		for(var j=0; j<7; j++){
			text(floor(100*result.getColumn(i+1)[j+1]/totalGraduates.getColumn(i+1)[j+1])+"%", circleStartX+25+75*i, circleStartY+25+75*j);
		}
	}
}

function barChart(){

	//Title
	textAlign(LEFT);
	textSize(14);
	noStroke();
	fill(0, 0, 60);
	text("GSAPP Degrees", startX, 15);

	//Toggle Icons
	fill(0, 0, 40);
	noStroke();
	rect(startX+(column-1)*60, 25, 40, 20);
	for(var i=0; i<6; i++){
		noFill();
		strokeWeight(1);
		stroke(200);
		rect(startX+i*60, 25, 40, 20);
	}
	noStroke();
	fill(0, 0, 60);
	textSize(12);
	textAlign(CENTER);
	text("All", startX+20, 40);
	text("2013", startX+80, 40);
	text("2012", startX+140, 40);
	text("2011", startX+200, 40);
	text("2010", startX+260, 40);
	text("2009", startX+320, 40);

	//Bar Chart
	var startY = 50;
	var spaceBetween = 25;
	var maxValue = 0;
	var totalYear = 0;
	var maxLength = 400;
	for (var i=1; i<result.getRowCount(); i++){
		maxValue = max(maxValue, result.getColumn(column)[i]);
		totalYear = totalYear + parseInt(result.getColumn(column)[i]);
	}
	textAlign(LEFT);
	textSize(8);
	var rectNum = 20;
	for(var i=1; i<result.getRowCount(); i++){
		noStroke;
		for(var j=0; j<map(result.getColumn(column)[i], 0, maxValue, 0, maxLength)/3; j++){
			fill(180, 100, map(j, 0, map(result.getColumn(column)[i], 0, maxValue, 0, maxLength)/3, 30, 100));
			rect(startX+j*3, startY+spaceBetween*i, 1, 7);
		}
		//rect(0, startY+spaceBetween*i, map(result.getColumn(column)[i], 0, maxValue, 0, maxLength), 10);
		noStroke();
		fill(0, 0, 60);
		text((round(result.getColumn(column)[i]/totalYear*100)).toString()+"%", startX+3+map(result.getColumn(column)[i], 0, maxValue, 0, maxLength), startY+spaceBetween*i+9);
		text(result.getColumn(0)[i], startX, startY+spaceBetween*i-2);
	}
}

function mousePressed(){
	if (mouseX > startX && mouseX < startX+40 && mouseY > 25 && mouseY < 45){
		column = 1;
		//print("hello all");
	}
	if (mouseX > startX+60 && mouseX < startX+100 && mouseY > 25 && mouseY < 45){
		column = 2;
		//print("hello 2013");
	}
	if (mouseX > startX+120 && mouseX < startX+160 && mouseY > 25 && mouseY < 45){
		column = 3;
		//print("hello 2012");
	}
	if (mouseX > startX+180 && mouseX < startX+220 && mouseY > 25 && mouseY < 45){
		column = 4;
		//print("hello 2011");
	}
	if (mouseX > startX+240 && mouseX < startX+280 && mouseY > 25 && mouseY < 45){
		column = 5;
		//print("hello 2010");
	}
	if (mouseX > startX+300 && mouseX < startX+340 && mouseY > 25 && mouseY < 45){
		column = 6;
		//print("hello 2009");
	}
	if (mouseX > 0 && mouseX < 175 && mouseY > 200 && mouseY < 220){
		graph = 0;
	}	
	if (mouseX > 0 && mouseX < 175 && mouseY > 230 && mouseY < 250){
		graph = 1;
	}
}
*/
</script>